<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.BarChart?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.chart.NumberAxis?>
<?import javafx.scene.chart.PieChart?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.layout.Region?>

<ScrollPane fitToWidth="true" fitToHeight="true"
            xmlns="http://javafx.com/javafx/21"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="org.dam2.adp.ecorastro.controller.AnalisisController"
            styleClass="scroll-transparente">

    <VBox spacing="20.0" styleClass="panel-base">
        <padding>
            <Insets top="30" right="30" bottom="30" left="30"/>
        </padding>

        <HBox alignment="CENTER_LEFT" spacing="20">
            <VBox>
                <Label text="AnÃ¡lisis de Impacto" styleClass="titulo"/>
                <Label text="Monitoriza y compara tu huella" styleClass="subtitulo"/>
            </VBox>

            <Region HBox.hgrow="ALWAYS"/>

            <HBox spacing="10" alignment="CENTER_LEFT"
                  style="-fx-background-color: white; -fx-background-radius: 8; -fx-padding: 10; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.05), 5, 0, 0, 0);">
                <Label text="Ver:" style="-fx-font-weight: bold; -fx-text-fill: -color-terciario;"/>

                <ComboBox fx:id="cmbRango" prefWidth="120"/>
                <DatePicker fx:id="dpFecha" prefWidth="140" promptText="Seleccionar fecha"/>

                <Separator orientation="VERTICAL"/>

                <Button text="ðŸ“¥ Exportar Informe" onAction="#exportarReporte"
                        styleClass="boton-secundario" style="-fx-font-size: 12px;"/>
            </HBox>
        </HBox>

        <HBox spacing="20" VBox.vgrow="ALWAYS">

            <VBox spacing="20" HBox.hgrow="ALWAYS">
                <HBox styleClass="card" spacing="20" alignment="CENTER_LEFT">
                    <VBox>
                        <Label text="TOTAL PERIODO" styleClass="card-titulo"/>
                        <Label fx:id="lblTotalPeriodo" text="0.00 kg" styleClass="card-numero-destacado"/>
                    </VBox>
                    <Separator orientation="VERTICAL"/>
                    <VBox>
                        <Label text="ACTIVIDAD FRECUENTE" styleClass="card-titulo"/>
                        <Label fx:id="lblActividadFrecuente" text="-" styleClass="card-numero"
                               style="-fx-font-size: 18px;"/>
                    </VBox>
                </HBox>

                <VBox styleClass="card" VBox.vgrow="ALWAYS">
                    <Label text="DESGLOSE POR CATEGORÃA" styleClass="card-titulo"/>
                    <PieChart fx:id="pieChart" VBox.vgrow="ALWAYS" minHeight="250" legendSide="RIGHT"/>
                </VBox>
            </VBox>

            <VBox styleClass="card" HBox.hgrow="ALWAYS" alignment="TOP_CENTER">
                <Label text="TÃš VS LA COMUNIDAD (MEDIA)" styleClass="card-titulo" maxWidth="Infinity"
                       alignment="CENTER_LEFT"/>
                <Label text="Comparativa de emisiones por categorÃ­a" styleClass="subtitulo" maxWidth="Infinity"
                       alignment="CENTER_LEFT"/>

                <BarChart fx:id="barChart" VBox.vgrow="ALWAYS" minHeight="400" legendSide="BOTTOM" animated="false">
                    <xAxis>
                        <CategoryAxis label=""/>
                    </xAxis>
                    <yAxis>
                        <NumberAxis label="kg COâ‚‚"/>
                    </yAxis>
                </BarChart>
            </VBox>
        </HBox>

        <HBox styleClass="card-azul" spacing="20" alignment="CENTER_LEFT">
            <Label text="ðŸ¤–" style="-fx-font-size: 34px; -fx-text-fill: white;"/>
            <VBox>
                <Label text="ANÃLISIS INTELIGENTE" styleClass="titulo-tip"/>
                <Label fx:id="lblInsight" text="Analizando tus hÃ¡bitos..."
                       textFill="WHITE" wrapText="true" style="-fx-font-size: 14px;"/>
            </VBox>
        </HBox>

    </VBox>
</ScrollPane>